# =============================================================================
# LegacyKeep Notification Service - Test Configuration
# =============================================================================

# Test Application Configuration
spring.application.name=notification-service-test
server.port=0

# =============================================================================
# Test Database Configuration (TestContainers)
# =============================================================================

# Use TestContainers for database
spring.datasource.url=jdbc:tc:postgresql:14:///test_db
spring.datasource.driver-class-name=org.testcontainers.jdbc.ContainerDatabaseDriver

# JPA Configuration for Tests
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Disable Flyway for tests (we'll use hibernate ddl-auto)
spring.flyway.enabled=false

# =============================================================================
# Test Email Configuration (JavaMailSender Mock)
# =============================================================================

# Use GreenMail for email testing
spring.mail.host=localhost
spring.mail.port=3025
spring.mail.username=test@legacykeep.com
spring.mail.password=test-password
spring.mail.properties.mail.smtp.auth=false
spring.mail.properties.mail.smtp.starttls.enable=false

# Email Template Configuration
notification.email.from=test@legacykeep.com
notification.email.from-name=LegacyKeep Test
notification.email.templates.path=classpath:templates/email
notification.email.templates.cache.enabled=false

# =============================================================================
# Test Kafka Configuration (Embedded Kafka)
# =============================================================================

# Use embedded Kafka for testing
spring.kafka.bootstrap-servers=localhost:9092
spring.kafka.consumer.group-id=notification-service-test-group
spring.kafka.consumer.auto-offset-reset=earliest

# =============================================================================
# Test Redis Configuration (Embedded Redis)
# =============================================================================

# Use embedded Redis for testing
spring.redis.host=localhost
spring.redis.port=6379
spring.redis.database=1

# =============================================================================
# Test Notification Configuration
# =============================================================================

# Notification Settings for Testing
notification.rate-limit.max-per-minute=1000
notification.rate-limit.max-per-hour=10000
notification.retry.max-attempts=1
notification.retry.initial-delay=100
notification.retry.multiplier=1.0
notification.retry.max-delay=500

# Template Configuration for Testing
notification.templates.email.base-url=http://localhost:3000
notification.templates.email.verification.expiry-hours=24
notification.templates.email.password-reset.expiry-hours=1

# =============================================================================
# Test Security Configuration
# =============================================================================

# JWT Configuration for Testing
notification.jwt.secret=test-jwt-secret-key-for-testing-only
notification.jwt.expiration=3600000

# Service Authentication for Testing
notification.security.enabled=false
notification.security.service-token=test-service-token

# =============================================================================
# Test Logging Configuration
# =============================================================================

# Logging Levels for Tests
logging.level.com.legacykeep.notification=DEBUG
logging.level.org.springframework.mail=DEBUG
logging.level.org.apache.kafka=WARN
logging.level.org.springframework.kafka=WARN

# =============================================================================
# Test Actuator Configuration
# =============================================================================

# Actuator Configuration for Tests
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.metrics.export.prometheus.enabled=false

# =============================================================================
# Test Profiles
# =============================================================================

# Test Profile Configuration
spring.test.database.replace=none
